<!DOCTYPE html>




<html lang="ja">
  <head>
    <meta charset="utf-8" />
    
    <title>REPL &mdash; Clojure の日本語ガイド</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="../../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="../../_static/css/bootstrap3/bootswatch-cosmo.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" href="../../_static/css/adjust_theme/bootswatch-cosmo.css" type="text/css" />

<link rel="stylesheet" href="../../_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="../../_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     '0.0.1',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="../../_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../../_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="top" title="Clojure の日本語ガイド" href="../../index.html" />
    <link rel="up" title="IntelliJ IDEA と Cursive で始める" href="../intellij_with_cursive.html" />
    <link rel="prev" title="Leiningen を使う" href="leiningen.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html">Clojure の日本語ガイド</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">目次 <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">REPL</a><ul>
<li><a class="reference internal" href="#id1">ローカル REPL</a></li>
<li><a class="reference internal" href="#id2">デバッグ REPL を開始する</a></li>
<li><a class="reference internal" href="#repl-startup-timeout">REPL startup timeout</a></li>
<li><a class="reference internal" href="#remote-repls">Remote REPLs</a></li>
<li><a class="reference internal" href="#using-the-repl">Using the REPL</a></li>
<li><a class="reference internal" href="#interaction-with-the-editor">Interaction with the editor</a></li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="leiningen.html" title="Leiningen を使う" accesskey="P">前へ </a></li>
              <li><a href="../../genindex.html" title="総合索引" accesskey="I">索引 </a></li>
              <li><a href="../index.html" >Clojure を始めよう</a></li>
              <li><a href="../intellij_with_cursive.html" accesskey="U">IntelliJ IDEA と Cursive で始める</a></li>
            
            <li class="visible-xs"><a href="../../_sources/getting_started/intellij_with_cursive/repl.txt" rel="nofollow">ソースコードを表示</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="../../search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="検索" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation"><div id="toc" class="sidebarRow">

<h3><a href="../../index.html">目次</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Clojure を始めよう</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../clojure_on_web.html">Clojure を Web で試してみる</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../clojure_on_web.html#try-clojure-clojure">Try Clojure で Clojure を試してみる</a></li>
<li class="toctree-l3"><a class="reference internal" href="../clojure_on_web.html#clojure-instarepl-clojure">Clojure  instaREPL で Clojure を試してみる</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../intellij_with_cursive.html">IntelliJ IDEA と Cursive で始める</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intellij_with_cursive.html#id2">概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intellij_with_cursive.html#id3">機能</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../intellij_with_cursive.html#id4">ユーザーガイド</a></li>
</ul>
</li>
</ul>
</li>
</ul>


</div>
<link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <h4>前のトピックへ</h4>
  <p class="topless"><a href="leiningen.html"
                        title="前の章へ">Leiningen を使う</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/getting_started/intellij_with_cursive/repl.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" role="search">
  <h3>クイック検索</h3>
  <form class="search form-inline" action="../../search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="検索" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="repl">
<h1>REPL<a class="headerlink" href="#repl" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>REPL は Clojure の開発環境になくてはならないものであり Cursive も例外ではありません。 Cursive は nREPL を使っています。それは Clojure のためのデファクトスタンダードな REPL の基盤です。</p>
<div class="section" id="id1">
<h2>ローカル REPL<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>REPL は Run Configurations から起動出来ます。もしあなたが Leiningen をプロジェクトで使っているなら直接 Leiningen プラグイン( lein-immutant など)を用いて REPL を起動することが出来ます。他には IntelliJ モジュール設定基盤の上でも REPL を起動出来ます。</p>
<p>新しい設定を作成します、 <code class="docutils literal"><span class="pre">Run</span></code> -&gt; <code class="docutils literal"><span class="pre">Edit</span> <span class="pre">Configurations…</span></code> と開き + で新しい設定を作成します。 Clojure REPL の Local を選択します。</p>
<img alt="../../_images/create-local-config.png" src="../../_images/create-local-config.png" />
<p>それから設定に名前を付けることができます。また REPL を実行するのに Leiningen を使うから直接起動するかを選択できます。もしあなたが Leiningen を使ってプロジェクトを管理しているのならほぼ間違いなく Leiningen で REPL を起動させたいと思います。場合によって、あなたはどのモジュールを使うのか、どこから Leiningen プロジェクトを実行するのか、特別な JVM の引数、環境変数、それとワーキングディレクトリを選択することができます。</p>
<img alt="../../_images/local-repl-options.png" src="../../_images/local-repl-options.png" />
<p>REPL を Leiningen を使って実行する場合、 Cursive は内部的に <code class="docutils literal"><span class="pre">lein</span> <span class="pre">trampoline</span></code> と同様のメカニズムを使っています。もし何かしらの理由であなたの REPL が <code class="docutils literal"><span class="pre">trampoline</span></code> を使って正しく動かない場合は、代わりに下で述べるリモート REPL の項を見てください。</p>
<p>設定編集ウィンドウの下部から、あなたの設定を走らせる前に実行するタスクを修正できます。特に興味深い設定は <code class="docutils literal"><span class="pre">Synchronize</span> <span class="pre">Leiningen</span> <span class="pre">projects</span></code> と <code class="docutils literal"><span class="pre">Make</span></code> でしょう。これらは Leiningen プロジェクトと Cursive プロジェクトの依存性を同期し、プロジェクトをビルドします。 <code class="docutils literal"><span class="pre">Synchronize</span> <span class="pre">Leiningen</span> <span class="pre">projects</span></code> は Leiningen の実行構成を動作させるためには必要ありません。 Leiningen は REPL を起動する前にプロジェクトファイルを再読み込みするので、このオプションを付けても REPL の起動が遅くなるだけでしょう。</p>
<img alt="../../_images/before-launch-tasks.png" src="../../_images/before-launch-tasks.png" />
<p>もし特定の実行構成タイプの初期設定を変更したければ、左側 Defaults セクションから変更出来ます。新しい設定を作成する場合にその設定が使用されます。</p>
<p>それらには同様の実行構成を作成するためのショートカットがあります。もし、プロジェクトウィンドウのソースルート以外の適当なところで右クリックをしたら、直接実行構成を作成するための選択肢が表示されます。</p>
<img alt="../../_images/repl-context-menu.png" src="../../_images/repl-context-menu.png" />
</div>
<div class="section" id="id2">
<h2>デバッグ REPL を開始する<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>非常に有用なひとつの特徴は REPL セッションをデバッグできることです。これは今とても単純です。あなたのローカル設定をデバッグモードで実行するとデバッガーは自動的に接続します。</p>
<img alt="../../_images/local-debug-config.png" src="../../_images/local-debug-config.png" />
<p>Cursive でデバッグすることで非常に困難なことのひとつはローカルクリアリング(locals clearing) <a class="footnote-reference" href="#id4" id="id3">[1]</a> です。それは Clojure コンパイラがメモリ参照へとコードを挿入するという意味であり、二度と <code class="docutils literal"><span class="pre">nil</span></code> にならないということです。これはデバッグ時に問題になります。you will see many of your local variables set to null when the code you are looking at could never have caused them to take that value. 常に遅延シーケンスをメモリに確保することで常に値と順序の変わらない同じシーケンスを返し、こうすることで遅延シーケンス起因のメモリリークを防ぐことができます。それは新しくやってきた人には混乱をもたらし、全ての人がデバッグ時にフラストレーションを感じることでしょう。</p>
<p>Cursvie は全てのデバッグ REPL でローカルクリアリングを無効にして開始し、全ての REPL はツールウィンドウの <img alt="start-debug" src="../../_images/startDebugger.png" /> ボタンから REPL サーバーのデバッグモードをトグル出来ます。注目するのはこれがコンパイラの機能であるということで、つまりコンパイル時のみに影響があるということであり、それはランタイムフラグではありません。</p>
<p>This means that if you toggle it you must recompile any code you’d like to debug. This generally means reloading it in the REPL after turning the flag on. Also, be very careful disabling locals clearing in any long-running process (e.g. a production server process) since it may cause memory leaks.</p>
</div>
<div class="section" id="repl-startup-timeout">
<h2>REPL startup timeout<a class="headerlink" href="#repl-startup-timeout" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Cursive also supports configuring the REPL startup timeout. This is the time that Cursive will wait for the REPL to start before assuming something has gone wrong. By default it’s set to 60 seconds. You can change this value at Settings→Clojure→REPL startup timeout.</p>
</div>
<div class="section" id="remote-repls">
<h2>Remote REPLs<a class="headerlink" href="#remote-repls" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Alternatively, if you already have an nREPL server running somewhere, you can connect to it using a Remote configuration. There are two options here - either you can configure it to connect to a host and port, or you can configure it to connect to 127.0.0.1 and get the port from the port file written by Leiningen. You can use this option if you want to start a REPL with Leiningen from the command line for some reason (for example, your REPL doesn’t work with the trampoline option used by Cursive).</p>
<img alt="../../_images/remote-repl-config.png" src="../../_images/remote-repl-config.png" />
<p>You can start as many REPLs as you like of whatever type, and they’ll appear in tabs in the REPL tool window.</p>
</div>
<div class="section" id="using-the-repl">
<h2>Using the REPL<a class="headerlink" href="#using-the-repl" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Now that you have your REPL running, you can type code into the editor window below, the results appear above. The current namespace is shown in the tab title at the top of the tool window. You can execute code by pressing Enter if the cursor is at the end of a valid form, or you can execute at any time by pressing Ctrl Enter (Cmd Enter on the Mac). The editor is fully multi-line, and supports all functionality available in the main Clojure editor. You can move through your command history by using the up/down arrow keys, or jump between multi line items using Ctrl and arrow keys (Cmd arrows on Mac). If you don’t want the editor to move between history items using the normal arrow keys, you can disable this with Settings→Clojure→Up/Down arrow keys move between history items.</p>
<p>Using the buttons above the output window, you can interrupt the current execution, toggle soft wrapping of the output, clear the output, stop the REPL and reconnect (for remote REPLs).</p>
</div>
<div class="section" id="interaction-with-the-editor">
<h2>Interaction with the editor<a class="headerlink" href="#interaction-with-the-editor" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Often you’ll be editing code in the main project windows, and you’ll want to send code from your project to the running REPL. The commands to do this are under Tools→REPL. “Load file in REPL” will send the contents of the current editor window to the REPL, execute its contents and switch to the first namespace in the file, if any. A message will be printed out so you can see what happened.</p>
<p>“Load file in REPL” will calculate all the namespace dependencies of the file you’re loading, and will also load those dependencies in the correct order if any of them are out of date. This is very useful when editing multi-namespace projects as it’s often easy to forget when you’ve updated a file containing a function used by the main code you’re working on. It’s also very useful when working on code that’s require’d by its tests.</p>
<p>“Sync files in REPL” will load all out-of-date files from the editor to the REPL in the correct order, using the same transitive dependency calculation as “Load file in REPL”. It will not change the active namespace in the REPL.</p>
<p>This loading of dependent namespaces can have unexpected side effects, especially if one of the dependent namespaces creates data that would be overwritten by reloading it. If this bothers you, you can turn off this dependency functionality with Settings→Clojure→Load out-of-date file dependencies transitively.</p>
<img alt="../../_images/repl-load-file.png" src="../../_images/repl-load-file.png" />
<p>You can also switch the REPL namespace to that of the current file using “Switch REPL NS to current file”, and execute individual forms from the editor using the “Run form before cursor” and “Run top form” commands.</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>訳しててよくわからないのであとで修正するかもしれない。</td></tr>
</tbody>
</table>
</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="../../index.html">Clojure の日本語ガイド</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="leiningen.html" title="Leiningen を使う" >前へ</a></li>
        <li><a href="../../genindex.html" title="総合索引" >索引</a></li>
        <li><a href="../index.html" >Clojure を始めよう</a></li>
        <li><a href="../intellij_with_cursive.html" >IntelliJ IDEA と Cursive で始める</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2015, ayato_p.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>